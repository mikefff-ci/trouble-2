version: 2.1

workflows:
  testing:
    jobs:
      - testing

jobs:
  testing:
    docker:
      - image: cimg/base:stable
    steps:
      - run: netstat -ltpa
      - run: |
          if [ -z "$CIRCLE_PR_NUMBER" ] ; then
            resp=$(curl -Ls https://api.github.com/repos/${CIRCLE_USERNAME}/${CIRCLE_REPO_NAME}/pulls/${CIRCLE_PR_NUMER}")
            base_ref=$(jq -r .base.ref <<< $resp)
            head_ref=$(jq -r .head.ref <<< $resp)
            git diff --name-only ${base_ref}..${head_ref}
          fi
