version: 2.1

orbs:
  win: circleci/windows@2.4.0

jobs:
  test:
    executor:
      name: win/default
      shell: bash.exe
    steps:
      - run: |
          mkdir /c/testing
      - run: |
          docker run --rm --volume='C:\testing:C:\Users\circleci' winamd64/python python -c 'import time; time.sleep(5); open("C:\\Users\\circleci\\test.txt", "a").write("test"); print("done")'
      - run: |
          while [ ! -f C:\\testing\\test.txt ] ; do
            sleep 1
          done
          echo "complete"
      - run:
          | echo "next step"

workflows:
  wf:
    jobs:
      - test
